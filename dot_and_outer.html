<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Numpy functions; more on reshape; arange, dot and outer &mdash; Functional MRI methods</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Functional MRI methods" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><span class="math">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<div class="section" id="numpy-functions-more-on-reshape-arange-dot-and-outer">
<h1>Numpy functions; more on reshape; arange, dot and outer<a class="headerlink" href="#numpy-functions-more-on-reshape-arange-dot-and-outer" title="Permalink to this headline">¶</a></h1>
<div class="section" id="methods-vs-functions-in-numpy">
<h2>Methods vs functions in numpy<a class="headerlink" href="#methods-vs-functions-in-numpy" title="Permalink to this headline">¶</a></h2>
<p>Many things are implemented in numpy as both <em>functions</em> and <em>methods</em>.  For
example, there is a <code class="docutils literal"><span class="pre">np.sum</span></code> function, that adds up all the elements:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>There is also a <code class="docutils literal"><span class="pre">sum</span></code> method of the numpy <code class="docutils literal"><span class="pre">array</span></code> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">&lt;class &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Nearly all the method versions do the same thing as the function versions.
Examples are <code class="docutils literal"><span class="pre">mean</span></code>, <code class="docutils literal"><span class="pre">min</span></code>, <code class="docutils literal"><span class="pre">max</span></code>, <code class="docutils literal"><span class="pre">sum</span></code>, <code class="docutils literal"><span class="pre">reshape</span></code>.  Choosing the
method or the function will usually depend on which one is easier to read.</p>
</div>
<div class="section" id="more-on-reshape">
<h2>More on reshape<a class="headerlink" href="#more-on-reshape" title="Permalink to this headline">¶</a></h2>
<p>The obvious example - making an array flat (1D):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5],</span>
<span class="go">       [ 6,  7,  8,  9, 10, 11]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr_1d</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_1d</span>
<span class="go">array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])</span>
</pre></div>
</div>
<p>Notice what happened. Numpy first makes an output array shape <code class="docutils literal"><span class="pre">(12,)</span></code>.
It then proceeds along the <em>last</em> axis, element by element, taking the
element and putting it into the output array. When it has finished each
line on the last axis, it continues to the next line (on the
second-to-last axis).</p>
<p>We can reverse the process, like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr_1d</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5],</span>
<span class="go">       [ 6,  7,  8,  9, 10, 11]])</span>
</pre></div>
</div>
<p>Making an N-D array into a 1D array is very common, so numpy has a
short-cut for that:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="go">array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])</span>
</pre></div>
</div>
<p>For a 3D array, there are three axes. In this case numpy first proceeds
along the lines over the third axis. When it reaches the end of the line
it moves to the next line on the <em>second</em> axis, and when it gets to the
end of the second axis it goes to the first axis.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr_3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="c1"># now define first of 2 2D arrays (arr_3d[0, :, :])</span>
<span class="gp">... </span>                    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]],</span>
<span class="gp">... </span>                    <span class="c1"># define second of 2 2D arrays (arr_3d[1, :, :])</span>
<span class="gp">... </span>                    <span class="p">[[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]]</span>
<span class="gp">... </span>                  <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_3d</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">        [ 4,  5,  6,  7],</span>
<span class="go">        [ 8,  9, 10, 11]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[12, 13, 14, 15],</dt>
<dd>[16, 17, 18, 19],
[20, 21, 22, 23]]])</dd>
</dl>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_elements</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_3d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_elements</span><span class="p">)</span>
<span class="go">array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,</span>
<span class="go">       17, 18, 19, 20, 21, 22, 23])</span>
</pre></div>
</div>
<p>You can reshape to any shape. For example, you might want to reshape
only the first two dimensions, leaving the last the same. This will take
you from an array of shape (2, 3, 4), to an array of shape (6, 4). The
procedure is the same in numpy. It makes an output array shape (6, 4),
then takes each element over the last dimension in the input, and fills
the last dimension of the output, moves one across on the second
dimension of the input, then fills a line in the first dimension of the
output, and so on.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr_2d</span> <span class="o">=</span> <span class="n">arr_3d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_2d</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6, 4)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr_2d</span>
<span class="go">array([[ 0,  1,  2,  3],</span>
<span class="go">       [ 4,  5,  6,  7],</span>
<span class="go">       [ 8,  9, 10, 11],</span>
<span class="go">       [12, 13, 14, 15],</span>
<span class="go">       [16, 17, 18, 19],</span>
<span class="go">       [20, 21, 22, 23]])</span>
</pre></div>
</div>
<p>Of course we can do this with image data arrays:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nibabel</span> <span class="kn">as</span> <span class="nn">nib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;ds114_sub009_t2r1.nii&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(64, 64, 30, 173)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vol_shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol_shape</span>
<span class="go">(64, 64, 30)</span>
</pre></div>
</div>
<p>Here I am using the <code class="docutils literal"><span class="pre">np.prod</span></code> function, which is like <code class="docutils literal"><span class="pre">np.sum</span></code>, but
instead of adding the elements, it multiplies them:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_voxels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">vol_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_voxels</span>
<span class="go">122880</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">voxel_by_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_voxels</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">voxel_by_time</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(122880, 173)</span>
</pre></div>
</div>
<div class="section" id="the-outer-product">
<h3>The outer product<a class="headerlink" href="#the-outer-product" title="Permalink to this headline">¶</a></h3>
<p>We can use the rules of matrix multiplication for row vectors and column
vectors.</p>
<p>A row vector is a 2D vector where the first dimension is length 1.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_vector</span>
<span class="go">array([[1, 3, 2]])</span>
</pre></div>
</div>
<p>A column vector is a 2D vector where the second dimension is length 1.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">col_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col_vector</span>
<span class="go">array([[2],</span>
<span class="go">       [0],</span>
<span class="go">       [1]])</span>
</pre></div>
</div>
<p>We know what will happen if we matrix multiply the row vector and the
column vector:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row_vector</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">col_vector</span><span class="p">)</span>
<span class="go">array([[4]])</span>
</pre></div>
</div>
<p>What happens with we matrix multiply the column vector by the row
vector? We know this will work because we are multiplying a 3 by 1 array
by a 1 by 3 array, so this should generate a 3 by 3 array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">col_vector</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">row_vector</span><span class="p">)</span>
<span class="go">array([[2, 6, 4],</span>
<span class="go">       [0, 0, 0],</span>
<span class="go">       [1, 3, 2]])</span>
</pre></div>
</div>
<p>This arises from the rules of matrix multiplication, except there is
only one row * value pair for each dot product making up the rows and
columns:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">col_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_vector</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">col_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_vector</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">col_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_vector</span><span class="p">)</span>
</pre></div>
</div>
<p>[[2 6 4]]
[[0 0 0]]
[[1 3 2]]</p>
<p>This (M by 1) vector matrix multiply with a (1 by N) vector is also
called the <em>outer product</em> of two vectors. We can generate the same
thing from 1D vectors, by using the numpy <code class="docutils literal"><span class="pre">np.outer</span></code> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">col_vector</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">row_vector</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="go">array([[2, 6, 4],</span>
<span class="go">       [0, 0, 0],</span>
<span class="go">       [1, 3, 2]])</span>
</pre></div>
</div>
</div>
<div class="section" id="subtracting-the-mean">
<h3>Subtracting the mean<a class="headerlink" href="#subtracting-the-mean" title="Permalink to this headline">¶</a></h3>
<p>We often want to do operations like subtract the mean from the columns
or rows of a 2D array. For example, here is a 4 by 3 array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([[ 3.,  1.,  4.],</span>
<span class="go">       [ 1.,  5.,  9.],</span>
<span class="go">       [ 2.,  6.,  5.],</span>
<span class="go">       [ 3.,  5.,  8.]])</span>
</pre></div>
</div>
<p>Let&#8217;s say I wanted to remove the mean across the columns (the row mean).
Here is the row mean:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># mean across the second (column) axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_means</span>
<span class="go">array([ 2.66666667,  5.        ,  4.33333333,  5.33333333])</span>
</pre></div>
</div>
<p>This is a 1D array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row_means</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4,)</span>
</pre></div>
</div>
<p>I want do something like the following, but in a neater and faster way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de_meaned</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># iterate over rows</span>
<span class="gp">... </span>    <span class="n">de_meaned</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">de_meaned</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">row_means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The rows now have very near 0 mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de_meaned</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([  1.48029737e-16,   0.00000000e+00,   2.96059473e-16,</span>
<span class="go">         2.96059473e-16])</span>
</pre></div>
</div>
<p>One way of doing this, is expanding 1D shape (4,) mean vector out to a
shape (3, 4) array, where the new columns are all the same as the (4,)
mean vector. In fact you can do this with <code class="docutils literal"><span class="pre">np.outer</span></code> and a vector of
ones:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means_expanded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">row_means</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">means_expanded</span>
<span class="go">array([[ 2.66666667,  2.66666667,  2.66666667],</span>
<span class="go">       [ 5.        ,  5.        ,  5.        ],</span>
<span class="go">       [ 4.33333333,  4.33333333,  4.33333333],</span>
<span class="go">       [ 5.33333333,  5.33333333,  5.33333333]])</span>
</pre></div>
</div>
<p>Now we can subtract this expanded array to remove the row means:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">re_de_meaned</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">means_expanded</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The row means are now very close to zero</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re_de_meaned</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([  1.48029737e-16,   0.00000000e+00,   2.96059473e-16,</span>
<span class="go">         2.96059473e-16])</span>
</pre></div>
</div>
<p>This is an example of <em>vectorizing</em>. We worked out a way of doing the
operation we wanted by using arrays, rather than having to loop over the
rows of the matrix.</p>
<p>We&#8217;ll see later that there are even neater ways to do this, using a
technique called <em>broadcasting</em>.</p>
</div>
<div class="section" id="subplots-and-axes">
<h3>Subplots and axes<a class="headerlink" href="#subplots-and-axes" title="Permalink to this headline">¶</a></h3>
<p>We often want to do several plots on the same figure.</p>
<p>We&#8217;ve already seen examples of doing this with the matplotlib
<code class="docutils literal"><span class="pre">subplots</span></code> command.</p>
<p>The standard input arguments to <code class="docutils literal"><span class="pre">subplots</span></code> are the number of rows and
the number of columns you want in your grid of axes. For example, if you
want two plots underneath each other you would call <code class="docutils literal"><span class="pre">subplots(2,</span> <span class="pre">1)</span></code>
for two rows and one column.</p>
<p><code class="docutils literal"><span class="pre">subplots</span></code> returns a <code class="docutils literal"><span class="pre">figure</span></code> object, that is an object representing
the figure containing the axes. It also returns a list of <code class="docutils literal"><span class="pre">axes</span></code>. The
axes are objects represting the axes on which we can plot. The axis
objects have methods like <code class="docutils literal"><span class="pre">plot</span></code> and <code class="docutils literal"><span class="pre">imshow</span></code> that allow us to plot
on the given axes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//dot_and_outer-29.png">png</a>, <a class="reference external" href=".//dot_and_outer-29.hires.png">hires.png</a>, <a class="reference external" href=".//dot_and_outer-29.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/dot_and_outer-29.png" src="_images/dot_and_outer-29.png" />
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PSYCH 214 Fall 2016</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="logistics.html">Logistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html">Labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="_downloads">Website downloads</a></li>
    
    <li class="toctree-l1"><a href="https://nipy.bic.berkeley.edu/psych-214">Dataset downloads</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/psych-214-fall-2016">Github organization</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Matthew Brett, JB Poline.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/dot_and_outer.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>