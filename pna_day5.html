<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Range &mdash; Functional MRI methods</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Functional MRI methods" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><span class="math">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># - compatibility with Python 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>  <span class="c1"># print(&#39;me&#39;) instead of print &#39;me&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>  <span class="c1"># 1/2 == 0.5, not 0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># - show figures inside the notebook</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># - import common modules</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>  <span class="c1"># the Python array package</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>  <span class="c1"># the Python plotting package</span>
</pre></div>
</div>
<div class="section" id="range">
<h1>Range<a class="headerlink" href="#range" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">range</span></code> is a built-in function in Python.</p>
<p>&#8220;built-in&#8221; means you can use <code class="docutils literal"><span class="pre">range</span></code> without having to <code class="docutils literal"><span class="pre">import</span></code> it.</p>
<p>In Python 2, <code class="docutils literal"><span class="pre">range</span></code> returns a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>In Python 3, range returns a special object that behaves rather like a
list, but doesn&#8217;t create the values until you need them. This is more
efficient in memory.</p>
<p>Here is <code class="docutils literal"><span class="pre">range</span></code> in Python 3:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">type</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">range</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<p>There are three ways of calling range - with 1, 2 or 3 arguments.</p>
<p>With just one argument, the argument value is the length of the returned
list, or, equivalently, the largest value in the list, plus 1 (as when
you do slicing), or, equivalently, the value <code class="docutils literal"><span class="pre">stop</span></code> such that no list
element is <code class="docutils literal"><span class="pre">&gt;=</span> <span class="pre">stop</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>If you pass 2 arguments, the first value is the first value in the
returned list, and the second value is the stop value:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>If you pass 3 arguments, the first value is the first returned value,
the second is the stop value, and the third is the step size.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="np-arange">
<h1>np.arange<a class="headerlink" href="#np-arange" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">arange</span></code> in numpy is very like range with two important differences:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">arange</span></code> returns an array rather than a list (in Python 2 or Python
3);</li>
<li><code class="docutils literal"><span class="pre">arange</span></code> arguments can be floating point values.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Because <code class="docutils literal"><span class="pre">arange</span></code> returns arrays, you can also multiply by the step
size and maybe add the start value to create equally spaced vectors:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="exponential-floating-point-format">
<h1>Exponential floating point format<a class="headerlink" href="#exponential-floating-point-format" title="Permalink to this headline">¶</a></h1>
<p>We have so far seen floating point numbers in this kind of format in
text files : <code class="docutils literal"><span class="pre">314.15926</span></code>.</p>
<p>It is common for numpy and MATLAB to write floating point numbers in
exponential format, like this <code class="docutils literal"><span class="pre">3.1415926e02</span></code>. You can read this as
meaning <code class="docutils literal"><span class="pre">3.1415926</span> <span class="pre">*</span> <span class="pre">10**2</span></code> == <code class="docutils literal"><span class="pre">3.1415926</span> <span class="pre">*</span> <span class="pre">100</span></code> == <code class="docutils literal"><span class="pre">314.15926</span></code>.
Both <code class="docutils literal"><span class="pre">np.loadtxt</span></code> and the <code class="docutils literal"><span class="pre">float</span></code> function will happily convert
these to floating point values in memory:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;2.2e02&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="legends-on-plots">
<h1>Legends on plots<a class="headerlink" href="#legends-on-plots" title="Permalink to this headline">¶</a></h1>
<p>We have already seen that we can plot two things onto the same plot:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-15.png">png</a>, <a class="reference external" href=".//pna_day5-15.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-15.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-15.png" src="_images/pna_day5-15.png" />
</div>
<p>It can be hard to remember which plot is which (is green the sin or the
cos)? <code class="docutils literal"><span class="pre">label</span></code> and <code class="docutils literal"><span class="pre">legend</span></code> are useful for that:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-16.png">png</a>, <a class="reference external" href=".//pna_day5-16.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-16.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-16.png" src="_images/pna_day5-16.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
</pre></div>
</div>
</div>
<div class="section" id="scipy">
<h1>Scipy<a class="headerlink" href="#scipy" title="Permalink to this headline">¶</a></h1>
<p><em>Scipy</em> is a large library of scientific routines that builds on top of
numpy.</p>
<p>You can think of numpy as being a subset of MATLAB, and numpy + scipy as
being as being roughly equivalent to MATLAB plus the MATLAB toolboxes.</p>
<p>Scipy has many sub-packages, for doing things like reading MATLAB
<code class="docutils literal"><span class="pre">.mat</span></code> files (<code class="docutils literal"><span class="pre">scipy.io</span></code>) or working with sparse matrices
(<code class="docutils literal"><span class="pre">scipy.sparse</span></code>). We are going to be using the functions and objects
for working with statistical distributions in <code class="docutils literal"><span class="pre">scipy.stats</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">scipy.stats</span></code> contains objects for working with many different
distributions. We are going to be working with <code class="docutils literal"><span class="pre">scipy.stats.gamma</span></code>,
which implements the <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution">gamma
distribution</a>.</p>
<p>In particular we are interested in the <a class="reference external" href="https://en.wikipedia.org/wiki/Probability_density_function">probability density
function</a>
(PDF) of the gamma distribution.</p>
<p>Because this is a function, we need to pass it an array of values at
which it will evaluate.</p>
<p>We can also pass various parameters which change the shape, location and
width of the gamma PDF. The most important is the first parameter (after
the input array) known as the <a class="reference external" href="https://en.wikipedia.org/wiki/Shape_parameter">shape
parameter</a> (<span class="math">\(k\)</span>
in the <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution">wikipedia page on gamma
distributions</a>).</p>
<p>First we chose some x values at which to sample from the gamma PDF:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we plot the gamma PDF for shape values of 2, 4, 8, 12.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;k=2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;k=4&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;k=8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;k=12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-20.png">png</a>, <a class="reference external" href=".//pna_day5-20.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-20.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-20.png" src="_images/pna_day5-20.png" />
</div>
<p>We will see more from the statistics distributions next week.</p>
</div>
<div class="section" id="correlation-coefficient">
<h1>Correlation coefficient<a class="headerlink" href="#correlation-coefficient" title="Permalink to this headline">¶</a></h1>
<p>By &#8220;correlation coefficient&#8221;, we mean the <a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient">Pearson product moment
correlation
coefficient</a>.</p>
<p>Let&#8217;s say I have two arrays, <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">20.57</span><span class="p">,</span>  <span class="mf">18.33</span><span class="p">,</span>  <span class="mf">20.8</span> <span class="p">,</span>  <span class="mf">18.77</span><span class="p">,</span>  <span class="mf">18.46</span><span class="p">,</span>  <span class="mf">21.09</span><span class="p">,</span>  <span class="mf">19.96</span><span class="p">,</span>  <span class="mf">20.61</span><span class="p">,</span>
<span class="gp">... </span>               <span class="mf">18.73</span><span class="p">,</span>  <span class="mf">19.6</span> <span class="p">,</span>  <span class="mf">18.15</span><span class="p">,</span>  <span class="mf">19.7</span> <span class="p">,</span>  <span class="mf">20.36</span><span class="p">,</span>  <span class="mf">20.39</span><span class="p">,</span>  <span class="mf">19.67</span><span class="p">,</span>  <span class="mf">20.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">28.98</span><span class="p">,</span>  <span class="mf">30.13</span><span class="p">,</span>  <span class="mf">29.64</span><span class="p">,</span>  <span class="mf">29.87</span><span class="p">,</span>  <span class="mf">28.78</span><span class="p">,</span>  <span class="mf">33.48</span><span class="p">,</span>  <span class="mf">31.36</span><span class="p">,</span>  <span class="mf">31.04</span><span class="p">,</span>
<span class="gp">... </span>               <span class="mf">30.43</span><span class="p">,</span>  <span class="mf">31.69</span><span class="p">,</span>  <span class="mf">27.08</span><span class="p">,</span>  <span class="mf">29.25</span><span class="p">,</span>  <span class="mf">29.5</span> <span class="p">,</span>  <span class="mf">30.04</span><span class="p">,</span>  <span class="mf">29.74</span><span class="p">,</span>  <span class="mf">30.06</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-22.png">png</a>, <a class="reference external" href=".//pna_day5-22.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-22.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-22.png" src="_images/pna_day5-22.png" />
</div>
<p>The numpy routine <code class="docutils literal"><span class="pre">np.corrcoef</span></code> gives me the correlation <em>matrix</em>
between <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr_matrix</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">corr_matrix[0,</span> <span class="pre">0]</span></code> is the correlation of <code class="docutils literal"><span class="pre">x</span></code> with itself,
<code class="docutils literal"><span class="pre">corr_matrix[1,</span> <span class="pre">0]</span></code> (and <code class="docutils literal"><span class="pre">corr_matrix[0,</span> <span class="pre">1]</span></code>) is the correlation of
<code class="docutils literal"><span class="pre">x</span></code> with <code class="docutils literal"><span class="pre">y</span></code>.</p>
<p>See the <a class="reference external" href="more_correlation.ipynb">correlation exercises</a> for more on
correlation.</p>
<p>Be careful - <code class="docutils literal"><span class="pre">np.correlate</span></code> is something else entirely.</p>
</div>
<div class="section" id="dot-products">
<h1>dot products<a class="headerlink" href="#dot-products" title="Permalink to this headline">¶</a></h1>
<p>If I have two vectors <span class="math">\(\mathbf{a}\)</span> with elements
<span class="math">\(a_0, a_1, ... a_{n-1}\)</span>, and <span class="math">\(\mathbf{b}\)</span> with elements
<span class="math">\(b_0, b_1, ... b_{n-1}\)</span> then the <a class="reference external" href="https://en.wikipedia.org/wiki/Dot_product">dot
product</a> is defined as:</p>
<div class="math">
\[\mathbf{a}\cdot \mathbf{b} = \sum_{i=0}^{n-1} a_ib_i = a_0b_0 + a_1b_1 + \cdots + a_{n-1}b_{n-1}\]</div>
<p>In code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The same thing as</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># Elementwise multiplication</span>
</pre></div>
</div>
<p>Matrix multiplication operates by taking dot products of the rows of the
first array (matrix) with the columns of the second.</p>
<p>Let&#8217;s say I have a matrix <span class="math">\(\mathbf{X}\)</span>, and <span class="math">\(X_{i,:}\)</span> is row
<span class="math">\(i\)</span> in <span class="math">\(\mathbf{X}\)</span>. I have a matrix <span class="math">\(\mathbf{Y}\)</span>, and
<span class="math">\(Y_{:,j}\)</span> is column <span class="math">\(j\)</span> in <span class="math">\(\mathbf{Y}\)</span>. The output
matrix <span class="math">\(\mathbf{Z} = \mathbf{X} \mathbf{Y}\)</span> has entry
<span class="math">\(Z_{i,j} = X_{i,:} \cdot Y_{:, j}\)</span>. We will see this often over
the next few weeks.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="convolution-and-the-tail-values">
<h1>Convolution and the tail values<a class="headerlink" href="#convolution-and-the-tail-values" title="Permalink to this headline">¶</a></h1>
<p>Let&#8217;s say I have a neural vector with a couple of spikes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># samples every 0.5 seconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neural_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">times</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neural_vector</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># At 5 seconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neural_vector</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># At 10 seconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">neural_vector</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-31.png">png</a>, <a class="reference external" href=".//pna_day5-31.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-31.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-31.png" src="_images/pna_day5-31.png" />
</div>
<p>Then I have my HRF function, sampled every half second, to match:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">hrf</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s2">&quot;A hemodynamic response function&quot;</span>
<span class="gp">... </span>    <span class="n">values</span> <span class="o">=</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">8.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mf">0.547</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Scale max to 1</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">values</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf_samples</span> <span class="o">=</span> <span class="n">hrf</span><span class="p">(</span><span class="n">hrf_times</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hrf_times</span><span class="p">,</span> <span class="n">hrf_samples</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-32.png">png</a>, <a class="reference external" href=".//pna_day5-32.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-32.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-32.png" src="_images/pna_day5-32.png" />
</div>
<p>The input neural vector is length 120, and the HRF vector is length 40:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">neural_vector</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hrf_samples</span><span class="p">))</span>
</pre></div>
</div>
<p>For reasons that may be familiar to you now, when we convolve the neural
vector with the hrf signal, we get an output that is length 120 + 40 - 1
= 159:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hemodynamic_prediction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">neural_vector</span><span class="p">,</span> <span class="n">hrf_samples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">hemodynamic_prediction</span><span class="p">)</span>
</pre></div>
</div>
<p>This is because of the HRF falling off the end of the input vector. The
value at index 120 in the new vector refers to time 60, and value 121
refers to time 60.5 seconds. To retain only the values in the new
hemodynamic vector that refer to times up to (not including) 60s, we can
just drop the last <code class="docutils literal"><span class="pre">len(hrf_signal)</span> <span class="pre">-</span> <span class="pre">1</span></code> values:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hemodynamic_for_60s</span> <span class="o">=</span> <span class="n">hemodynamic_prediction</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">neural_vector</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">neural_vector</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;neural vector&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">hemodynamic_for_60s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hemodynamic prediction&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//pna_day5-35.png">png</a>, <a class="reference external" href=".//pna_day5-35.hires.png">hires.png</a>, <a class="reference external" href=".//pna_day5-35.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/pna_day5-35.png" src="_images/pna_day5-35.png" />
</div>
</div>
<div class="section" id="getting-the-time-series-from-a-voxel">
<h1>Getting the time series from a voxel<a class="headerlink" href="#getting-the-time-series-from-a-voxel" title="Permalink to this headline">¶</a></h1>
<p>Let&#8217;s say I have a 4D image:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nibabel</span> <span class="kn">as</span> <span class="nn">nib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;ds114_sub009_t2r1.nii&#39;</span><span class="p">,</span> <span class="n">mmap</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p>Each element slicing over the last dimension, is a 3D volume:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vol0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p>The term <em>voxel</em> refers to a 3 dimensional pixel - a position in three
dimensional space.</p>
<p>These 3D volumes contain voxel values, for all of the 64, 64, 30 voxels,
for a single time point.</p>
<p>For example, let&#8217;s say I was interested at the voxel at (i, j, k)
coordinates (10, 23, 9):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vox_value</span> <span class="o">=</span> <span class="n">vol0</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vox_value</span>
</pre></div>
</div>
<p>This value is the value for this voxel (voxel at 10, 23, 9) for this
time point (first time point). This would be the value for the same
voxel at the second time point (volume index 1):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vol1</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<p>Of course I could get the value for this voxel, at every time point, by
doing a loop:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vox_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="n">vox_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">vox_values</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vox_values</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
<p>I can get the same effect by slicing over the last dimension:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sliced_vox_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliced_vox_values</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">vox_values</span> <span class="o">==</span> <span class="n">sliced_vox_values</span><span class="p">)</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PSYCH 214 Fall 2016</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="logistics.html">Logistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html">Labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="_downloads">Website downloads</a></li>
    
    <li class="toctree-l1"><a href="https://nipy.bic.berkeley.edu/psych-214">Dataset downloads</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/psych-214-fall-2016">Github organization</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Matthew Brett, JB Poline.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/pna_day5.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>