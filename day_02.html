<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>September 19: version control, 4D arrays, diagnostics &#8212; Functional MRI methods</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Functional MRI methods" href="index.html" />
    <link rel="up" title="Classes" href="classes.html" />
    <link rel="next" title="September 26: vectors, projection and PCA" href="day_03.html" />
    <link rel="prev" title="September 12: arrays, images and plotting" href="day_01.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><span class="math">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<div class="section" id="september-19-version-control-4d-arrays-diagnostics">
<h1>September 19: version control, 4D arrays, diagnostics<a class="headerlink" href="#september-19-version-control-4d-arrays-diagnostics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="d-arrays-and-time-series">
<h2>4D arrays and time series<a class="headerlink" href="#d-arrays-and-time-series" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Loading images with <a class="reference external" href="http://nipy.org/nibabel">nibabel</a>;</li>
<li>4D images as collections of 3D images;</li>
<li>getting volumes from 4D images;</li>
<li>getting time-series from 4D images by slicing;</li>
<li>intro page: <a class="reference internal" href="intro_to_4d.html"><span class="doc">Working with four dimensional images, masks and functions</span></a>;</li>
<li>exercise: <a class="reference internal" href="four_dimensions_exercise.html"><span class="doc">Four dimensions exercise</span></a>.</li>
</ul>
</div>
<div class="section" id="modules-and-functions">
<h2>Modules and functions<a class="headerlink" href="#modules-and-functions" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">intro <a class="reference internal" href="on_modules.html"><span class="doc">Modules and scripts</span></a>.</p>
</li>
<li><p class="first">exercise:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">psych</span><span class="o">-</span><span class="mi">214</span><span class="o">-</span><span class="n">fall</span><span class="o">-</span><span class="mi">2016</span><span class="o">/</span><span class="n">classwork</span>
<span class="n">cd</span> <span class="n">classwork</span><span class="o">/</span><span class="n">day_02</span>
<span class="n">ipython</span>
</pre></div>
</div>
<p>then (in IPython):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">run</span> <span class="n">spm_funcs</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="introduction-to-the-diagnostics-exercise">
<span id="diagnostics-preparation"></span><h2>Introduction to the diagnostics exercise<a class="headerlink" href="#introduction-to-the-diagnostics-exercise" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>reading bytes from a file;</li>
<li>calculating a hash from the bytes.</li>
</ul>
<p>See <a class="reference internal" href="lab_02.html#reading-git-objects"><span class="std std-ref">Looking at real git objects</span></a>.</p>
<ul class="simple">
<li>stripping and splitting strings with <code class="docutils literal"><span class="pre">my_string.strip()</span></code> and
<code class="docutils literal"><span class="pre">my_string.split()</span></code>;</li>
<li>raising Errors with <code class="docutils literal"><span class="pre">raise</span></code>;</li>
<li>manipulating paths with <code class="docutils literal"><span class="pre">os.path</span></code>.</li>
</ul>
<p>Split into groups, then:</p>
<ul>
<li><p class="first">Get the data for your group from the USB key(s);</p>
</li>
<li><p class="first">Tell me about your groups;</p>
</li>
<li><p class="first">&#8220;Fork&#8221; the repository for your group, to your github user:</p>
<blockquote>
<div><ul class="simple">
<li>Group 00 forks : <a class="reference external" href="https://github.com/psych-214-fall-2016/diagnostics-00">https://github.com/psych-214-fall-2016/diagnostics-00</a></li>
<li>Group 01 forks : <a class="reference external" href="https://github.com/psych-214-fall-2016/diagnostics-01">https://github.com/psych-214-fall-2016/diagnostics-01</a></li>
<li>Group 02 forks : <a class="reference external" href="https://github.com/psych-214-fall-2016/diagnostics-02">https://github.com/psych-214-fall-2016/diagnostics-02</a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Clone your forked repository.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">matthew</span><span class="o">-</span><span class="n">brett</span><span class="o">/</span><span class="n">diagnostics</span><span class="o">-</span><span class="mo">00</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">matthew-brett</span></code> is your github user name, and <code class="docutils literal"><span class="pre">00</span></code> is your group.</p>
</li>
<li><p class="first">Change directory into this new directory, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">diagnostics</span><span class="o">-</span><span class="mo">00</span>
</pre></div>
</div>
</li>
<li><p class="first">Unpack and copy the data from the USB key into your new <code class="docutils literal"><span class="pre">data</span></code> directory.
The following instructions assume you are running from the terminal in OSX
and Linux, or the git bash shell in Windows.</p>
<ul>
<li><p class="first">If you have already unpacked your <code class="docutils literal"><span class="pre">group0x.tar.gz</span></code> archive (where x can
be 0, 1 or 2), then copy the <code class="docutils literal"><span class="pre">*.nii</span></code> files to your data directory with
something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">data</span>
<span class="n">cp</span> <span class="o">~/</span><span class="n">Downloads</span><span class="o">/</span><span class="n">group00</span><span class="o">/*</span> <span class="o">.</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">~/Downloads/group00</span></code> is the directory you unpacked to;</p>
</li>
<li><p class="first">If you haven&#8217;t unpacked the archive yet, you can unpack the archive into
your data directory with:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">data</span>
<span class="n">tar</span> <span class="n">zxvf</span> <span class="o">~/</span><span class="n">Downloads</span><span class="o">/</span><span class="n">group00</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</li>
</ul>
<p>Your <code class="docutils literal"><span class="pre">data</span></code> directory should now contain 20 files with filenames starting
with <code class="docutils literal"><span class="pre">group0</span></code> and ending with <code class="docutils literal"><span class="pre">.nii</span></code>; another file called
<code class="docutils literal"><span class="pre">hash_list.txt</span></code>, and a file called <code class="docutils literal"><span class="pre">data_hashes.txt</span></code> that came with the
repository when you cloned it;</p>
</li>
<li><p class="first">Now do <code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code>.  You will see that none of the files that you have
just copied show up in git&#8217;s listing of untracked files.  This is because I
put a clever <code class="docutils literal"><span class="pre">.gitignore</span></code> file in the <code class="docutils literal"><span class="pre">data</span></code> directory, to tell git to
ignore all files except the <code class="docutils literal"><span class="pre">data_hashes.txt</span></code> file.  You can see the file
by opening it in Atom with <code class="docutils literal"><span class="pre">atom</span> <span class="pre">.gitignore</span></code>;</p>
</li>
<li><p class="first">If your terimal is currently running in the <code class="docutils literal"><span class="pre">data</span></code> subdirectory, change
directory back to the <code class="docutils literal"><span class="pre">diagnostics-00</span></code> (etc) directory with <code class="docutils literal"><span class="pre">cd</span> <span class="pre">..</span></code>;</p>
</li>
<li><p class="first">Have a look at <code class="docutils literal"><span class="pre">hash_list.txt</span></code> file, by opening it in Atom:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">atom</span> <span class="n">data</span><span class="o">/</span><span class="n">hash_list</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>For each of the <code class="docutils literal"><span class="pre">.nii</span></code> files, <code class="docutils literal"><span class="pre">hash_list.txt</span></code> has a line with the SHA1
hash for that file, and the filename, separated by a space;</p>
</li>
<li><p class="first">You want to be able to confirm that your data has not beed overwritten or
corrupted.  To do this, you need to calculate the current hash for each
<code class="docutils literal"><span class="pre">.nii</span></code> file and compare it to the hash value in <code class="docutils literal"><span class="pre">hash_list.txt</span></code>;</p>
</li>
<li><p class="first">See <a class="reference internal" href="lab_02.html#reading-git-objects"><span class="std std-ref">Looking at real git objects</span></a> for a reminder of how to read file contents
and calculate the SHA1 hash for the contents;</p>
</li>
<li><p class="first">Now run <code class="docutils literal"><span class="pre">python3</span> <span class="pre">scripts/validata_data.py</span> <span class="pre">data</span></code>.  When you first run this
file, it will fail;</p>
</li>
<li><p class="first">Edit <code class="docutils literal"><span class="pre">scripts/validate_data.py</span></code> in Atom to fix.</p>
</li>
</ul>
</div>
<div class="section" id="reading-and-homework-for-next-week">
<h2>Reading and homework for next week<a class="headerlink" href="#reading-and-homework-for-next-week" title="Permalink to this headline">¶</a></h2>
<p>Reading is</p>
<ul class="simple">
<li>chapter 8 of Huettel et al 2014 <a class="reference internal" href="bibliography.html#huettel2014functional" id="id1">[HSM14]</a>;</li>
<li><a class="reference external" href="https://matthew-brett.github.io/curious-git/curious_remotes.html">curious remotes</a> – the Curious Git section on using git to work with
other repositories and other people.</li>
</ul>
<p>Homework is to continue the diagnostics exercise.</p>
<p>You have two weeks to do this exercise.</p>
<p>Your goal is to:</p>
<ol class="arabic simple">
<li>Fill out the script and any needed library code to run
<code class="docutils literal"><span class="pre">scripts/find_outliers.py</span> <span class="pre">data</span></code> on your data, and return a list of
outlier volumes for each scan (where there is an outlier);</li>
<li>You should add a text file giving a brief summary for each outlier scan,
why you think the detected scans should be rejected as an outlier, and your
educated guess as to the cause of the difference between this scan and the
rest of the scans in the run;</li>
<li>You should do this by collaborating in your teams using git and github;</li>
</ol>
<p>Grading will be on:</p>
<ul class="simple">
<li>the quality of your outlier detection as assessed by the improvement in the
statistical testing for the experimental model after removing the outliers;</li>
<li>the generality of your outlier detection as assessed by the improvement in
the statistical testing for the experimental model after removing the
outliers, for another similar dataset;</li>
<li>the quality of your code;</li>
<li>the quality and transparency of your process, from your interactions on
github;</li>
<li>the quality of your arguments about the scans rejected as outliers.</li>
</ul>
<p>We will cover more of the workflow in the Thursday lab.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PSYCH 214 Fall 2016</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="logistics.html">Logistics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html">Labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="_downloads">Website downloads</a></li>
    
    <li class="toctree-l1"><a href="https://nipy.bic.berkeley.edu/psych-214">Dataset downloads</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/psych-214-fall-2016">Github organization</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="classes.html">Classes</a><ul>
      <li>Previous: <a href="day_01.html" title="previous chapter">September 12: arrays, images and plotting</a></li>
      <li>Next: <a href="day_03.html" title="next chapter">September 26: vectors, projection and PCA</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Matthew Brett, JB Poline.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/day_02.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>